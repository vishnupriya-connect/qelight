<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Java Topics</title>
    <script src="https://cdn.jsdelivr.net/npm/showdown@2.0.0/dist/showdown.min.js"></script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
      }
      .markdown-section {
        margin-bottom: 2em;
      }
      .folder-heading {
        color: #2c3e50;
        font-size: 1.5em;
        margin-top: 1em;
      }
    </style>
  </head>
  <body>
    <div class="container my-4">
      <h1 class="text-center mb-4">Java Topics</h1>
      <div id="markdown-content"></div>
    </div>

    <script>
      async function fetchMarkdownFiles(folderPath) {
        const repoOwner = "vishnupriya-connect";
        const repoName = "qelight";
        const branch = "main";
        const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}?ref=${branch}`;

        try {
          const response = await fetch(apiUrl);
          const files = await response.json();

          // Filter and sort Markdown files alphabetically
          const markdownFiles = files
            .filter(file => file.name.endsWith(".md"))
            .sort((a, b) => a.name.localeCompare(b.name));

          const converter = new showdown.Converter();
          const contentDiv = document.getElementById("markdown-content");

          // Fetch each Markdown file content and display it in a collapsible format
          for (let i = 0; i < markdownFiles.length; i++) {
            const file = markdownFiles[i];
            const fileResponse = await fetch(file.download_url);
            const text = await fileResponse.text();
            const html = converter.makeHtml(text);

            // Collapsible content for each Markdown file
            contentDiv.innerHTML += `
              <div class="accordion" id="accordion-${folderPath}-${i}">
                <div class="accordion-item">
                  <h2 class="accordion-header" id="heading-${folderPath}-${i}">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-${folderPath}-${i}" aria-expanded="false" aria-controls="collapse-${folderPath}-${i}">
                      ${file.name.replace(".md", "")} <!-- File name as collapsible title -->
                    </button>
                  </h2>
                  <div id="collapse-${folderPath}-${i}" class="accordion-collapse collapse" aria-labelledby="heading-${folderPath}-${i}" data-bs-parent="#accordion-${folderPath}-${i}">
                    <div class="accordion-body markdown-section">
                      ${html}
                    </div>
                  </div>
                </div>
              </div>`;
          }
        } catch (error) {
          console.error(`Failed to fetch files from ${folderPath}:`, error);
        }
      }

      // Define folder paths to fetch
      const folderPaths = [
        "theory/corejava/1",
        "theory/corejava/2",
        "theory/corejava/3",
        "theory/jdbc",
        "theory/servlets",
        "theory/jsp",
      ];

      // Fetch Markdown files for each folder path
      folderPaths.forEach(fetchMarkdownFiles);
    </script>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
